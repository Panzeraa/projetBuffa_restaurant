{"remainingRequest":"/mnt/c/Users/yonib/Desktop/MIAGE/MASTER/Buffa/projetBuffa_restaurant/projetbuffa_modele_cli_router/node_modules/vue-loader/lib/index.js??vue-loader-options!/mnt/c/Users/yonib/Desktop/MIAGE/MASTER/Buffa/projetBuffa_restaurant/projetbuffa_modele_cli_router/src/components/RestaurantDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/mnt/c/Users/yonib/Desktop/MIAGE/MASTER/Buffa/projetBuffa_restaurant/projetbuffa_modele_cli_router/src/components/RestaurantDetail.vue","mtime":1577544236659},{"path":"/mnt/c/Users/yonib/Desktop/MIAGE/MASTER/Buffa/projetBuffa_restaurant/projetbuffa_modele_cli_router/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/mnt/c/Users/yonib/Desktop/MIAGE/MASTER/Buffa/projetBuffa_restaurant/projetbuffa_modele_cli_router/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/mnt/c/Users/yonib/Desktop/MIAGE/MASTER/Buffa/projetBuffa_restaurant/projetbuffa_modele_cli_router/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/mnt/c/Users/yonib/Desktop/MIAGE/MASTER/Buffa/projetBuffa_restaurant/projetbuffa_modele_cli_router/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUmVzdGF1cmFudERldGFpbCIsCiAgcHJvcHM6IHt9LAogIGNvbXB1dGVkOiB7IC8vIGNvbXB1dGVkIGRhdGEsIHBlcm1ldCBkZSBkw6lmaW5pciBkZXMgZGF0YSAiY2FsY3Vsw6llcyIKICAgIGlkKCkgewogICAgICAvLyBvbiB5IGFjY8OoZGVyYSBwYXIge3tpZH19IGRhbnMgbGUgdGVtcGxhdGUsIGV0IHBhciB0aGlzLmlkCiAgICAgIC8vIGRhbnMgbGUgY29kZQogICAgICByZXR1cm4gdGhpcy4kcm91dGUucGFyYW1zLmlkCiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICBMOiBudWxsLAogICAgICByZXN0YXVyYW50OiB7CiAgICAgICAgbmFtZTogbnVsbCwKICAgICAgICBjdWlzaW5lOiBudWxsLAogICAgICAgIGFkZHJlc3M6IHsKICAgICAgICAgIGJ1aWxkaW5nOiBudWxsLAogICAgICAgICAgc3RyZWV0OiBudWxsLAogICAgICAgICAgemlwY29kZTogbnVsbAogICAgICAgIH0KICAgICAgfSwKICAgICAgYXBpVVJMOiAiaHR0cDovL2xvY2FsaG9zdDo4MDgxL2FwaS9yZXN0YXVyYW50cyIsCiAgICAgIG1hcDogbnVsbCwKICAgICAgdGlsZUxheWVyOiBudWxsLAogICAgICBsYXllcnM6IFtdCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIGNvbnNvbGUubG9nKCJBVkFOVCBBRkZJQ0hBR0UgUmVzdG8hIik7CiAgICB0aGlzLkwgPSB3aW5kb3cuTDsKICAgIC8vY29uc29sZS5sb2coIk9uIHZhIGNoZXJjaGVyIGxlcyBkw6l0YWlscyBkdSByZXN0YXVyYW50IGlkID0gIiArIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCk7CiAgICB0aGlzLmdldERhdGFGcm9tU2VydmVyKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCk7CiAgICB0aGlzLmluaXRNYXAoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGdldERhdGFGcm9tU2VydmVyKGlkKSB7CiAgICAgIC8vIGljaSBvbiBmYWl0IHVuIGZldGNoIHBvdXIgcsOpY3Vww6lyZXIgbGUgZMOpdGFpbCBkdSByZXN0YXVyYW50CiAgICAgIGxldCB1cmwgPSB0aGlzLmFwaVVSTCArICIvIiArIGlkOwogICAgICB0cnkgewogICAgICAgIGxldCByZXBvbnNlSlNPTiA9IGF3YWl0IGZldGNoKHVybCwgewogICAgICAgICAgbWV0aG9kOiAiR0VUIgogICAgICAgIH0pOwogICAgICAgIGxldCByZXBvbnNlSlMgPSBhd2FpdCByZXBvbnNlSlNPTi5qc29uKCk7CiAgICAgICAgdGhpcy5yZXN0YXVyYW50ID0gcmVwb25zZUpTLnJlc3RhdXJhbnQ7CiAgICAgICAgY29uc29sZS5sb2cocmVwb25zZUpTKTsKICAgICAgICBpZiAodGhpcy5tYXAgIT0gbnVsbCkgewogICAgICAgICAgdGhpcy5tYXAuc2V0VmlldyhbdGhpcy5yZXN0YXVyYW50LmFkZHJlc3MuY29vcmRbMV0sIHRoaXMucmVzdGF1cmFudC5hZGRyZXNzLmNvb3JkWzBdXSwgMTgpOwogICAgICAgICAgdGhpcy5MLm1hcmtlcihbdGhpcy5yZXN0YXVyYW50LmFkZHJlc3MuY29vcmRbMV0sIHRoaXMucmVzdGF1cmFudC5hZGRyZXNzLmNvb3JkWzBdXSkuYWRkVG8odGhpcy5tYXApOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgY29uc29sZS5sb2coIkVycmV1ciBkYW5zIGxlcyBmZXRjaHMgR0VUICIgKyBlcnIubXNnKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIG1vZGlmaWVyUmVzdGF1cmFudChpZCkgewogICAgICAvLyBldml0ZXIgbGUgY29tcG9ydGVtZW50IHBhciBkZWZhdXQKICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgY29uc29sZS5sb2coaWQpOwogICAgICBsZXQgZG9ubmVlc0Zvcm11bGFpcmUgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgZG9ubmVlc0Zvcm11bGFpcmUuYXBwZW5kKCJub20iLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlKTsKICAgICAgZG9ubmVlc0Zvcm11bGFpcmUuYXBwZW5kKCJjdWlzaW5lIiwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmUnKS52YWx1ZSk7CiAgICAgIHRyeSB7CiAgICAgICAgbGV0IHVybCA9IHRoaXMuYXBpVVJMICsgIi8iICsgaWQ7CiAgICAgICAgbGV0IHJlcG9uc2VKU09OID0gYXdhaXQgZmV0Y2godXJsLCB7CiAgICAgICAgICBtZXRob2Q6ICJQVVQiLAogICAgICAgICAgYm9keTogZG9ubmVlc0Zvcm11bGFpcmUKICAgICAgICB9KTsKICAgICAgICBsZXQgcmVwb25zZUpTID0gYXdhaXQgcmVwb25zZUpTT04uanNvbigpOwogICAgICAgIGNvbnNvbGUubG9nKHJlcG9uc2VKUy5tc2cpOwogICAgICAgIHRoaXMucmVzdGF1cmFudC5uYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZTsKICAgICAgICB0aGlzLnJlc3RhdXJhbnQuY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lJykudmFsdWU7CiAgICAgICAgdGhpcy5yZXN0YXVyYW50LmFkZHJlc3MuYnVpbGRpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnVpbGRpbmcnKS52YWx1ZTsKICAgICAgICB0aGlzLnJlc3RhdXJhbnQuYWRkcmVzcy5zdHJlZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RyZWV0JykudmFsdWU7CiAgICAgICAgdGhpcy5yZXN0YXVyYW50LmFkZHJlc3MuemlwY29kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6aXBjb2RlJykudmFsdWU7CiAgICAgICAgdGhpcy5nZXREYXRhRnJvbVNlcnZlcihpZCk7IC8vIG9uIHJhZnJhaWNoaXQKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgY29uc29sZS5sb2coIkVycmV1ciBkYW5zIGxlIGZldGNocyBQVVQgIiArIGVyci5tc2cpOwogICAgICB9CiAgICB9LAogICAgaW5pdE1hcCgpIHsKICAgICAgY29uc29sZS5sb2coIkluaXRpYWxpc2F0aW9uIik7CiAgICAgIHRoaXMubWFwID0gdGhpcy5MLm1hcCgnbWFwJykuc2V0VmlldyhbNDMuNjI2NjMyMzQzMDI2MzYsIDcuMDY0MjA4OTg0Mzc1MDAxXSwgMTIpOwogICAgICB0aGlzLnRpbGVMYXllciA9IHRoaXMuTC50aWxlTGF5ZXIoCiAgICAgICAgICAgICAgJ2h0dHBzOi8ve3N9LnRpbGUub3BlbnN0cmVldG1hcC5vcmcve3p9L3t4fS97eX0ucG5nJywKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBtYXhab29tOiAxOCwKICAgICAgICAgICAgICAgIGF0dHJpYnV0aW9uOiAnJmNvcHk7IDxhIGhyZWY9Imh0dHA6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvY29weXJpZ2h0Ij5PcGVuU3RyZWV0TWFwPC9hPiwgJmNvcHk7IDxhIGhyZWY9Imh0dHBzOi8vY2FydG8uY29tL2F0dHJpYnV0aW9uIj5DQVJUTzwvYT4nLAogICAgICAgICAgICAgIH0KICAgICAgKTsKICAgICAgdGhpcy50aWxlTGF5ZXIuYWRkVG8odGhpcy5tYXApOwogICAgICB0aGlzLm1hcC5vbignY2xpY2snLCAoZSkgPT4gewogICAgICAgIHZhciBwb3MgPSBlLmxhdGxuZzsKICAgICAgICBjb25zb2xlLmxvZyhwb3MpOwogICAgICB9KTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["RestaurantDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RestaurantDetail.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <h1>Restaurant {{restaurant.name}}</h1>\n    <h2>Situé au {{restaurant.address.building}} {{restaurant.address.street}} ,{{restaurant.address.zipcode}} </h2>\n\n    <form v-on:submit=\"modifierRestaurant(id)\">\n      <div class=\"md-title\">Modifier restaurant</div>\n      Nom :\n      <input name=\"name\" id=\"name\" v-model=\"restaurant.name\" /><br>\n      Cuisine:\n      <input name=\"cuisine\" id=\"cuisine\" v-model=\"restaurant.cuisine\" /><br>\n      <p>Address</p>\n      Building : <input name=\"building\" id=\"building\" v-model=\"restaurant.address.building\" /><br>\n      Street : <input name=\"street\" id=\"street\" v-model=\"restaurant.address.street\" /><br>\n      Zipcode : <input name=\"zipcode\" id=\"zipcode\" v-model=\"restaurant.address.zipcode\" /><br>\n      <md-button type=\"submit\">Modifier restaurant</md-button>\n    </form>\n\n    <div id=\"map\" class=\"map\"></div>\n  </div>\n</template>\n\n<script>\n  export default {\n    name: \"RestaurantDetail\",\n    props: {},\n    computed: { // computed data, permet de définir des data \"calculées\"\n      id() {\n        // on y accèdera par {{id}} dans le template, et par this.id\n        // dans le code\n        return this.$route.params.id\n      }\n    },\n    data: function () {\n      return {\n        L: null,\n        restaurant: {\n          name: null,\n          cuisine: null,\n          address: {\n            building: null,\n            street: null,\n            zipcode: null\n          }\n        },\n        apiURL: \"http://localhost:8081/api/restaurants\",\n        map: null,\n        tileLayer: null,\n        layers: []\n      };\n    },\n    mounted() {\n      console.log(\"AVANT AFFICHAGE Resto!\");\n      this.L = window.L;\n      //console.log(\"On va chercher les détails du restaurant id = \" + this.$route.params.id);\n      this.getDataFromServer(this.$route.params.id);\n      this.initMap();\n    },\n    methods: {\n      async getDataFromServer(id) {\n        // ici on fait un fetch pour récupérer le détail du restaurant\n        let url = this.apiURL + \"/\" + id;\n        try {\n          let reponseJSON = await fetch(url, {\n            method: \"GET\"\n          });\n          let reponseJS = await reponseJSON.json();\n          this.restaurant = reponseJS.restaurant;\n          console.log(reponseJS);\n          if (this.map != null) {\n            this.map.setView([this.restaurant.address.coord[1], this.restaurant.address.coord[0]], 18);\n            this.L.marker([this.restaurant.address.coord[1], this.restaurant.address.coord[0]]).addTo(this.map);\n          }\n        } catch (err) {\n          console.log(\"Erreur dans les fetchs GET \" + err.msg);\n        }\n      },\n      async modifierRestaurant(id) {\n        // eviter le comportement par defaut\n        event.preventDefault();\n        console.log(id);\n        let donneesFormulaire = new FormData();\n        donneesFormulaire.append(\"nom\", document.getElementById('name').value);\n        donneesFormulaire.append(\"cuisine\", document.getElementById('cuisine').value);\n        try {\n          let url = this.apiURL + \"/\" + id;\n          let reponseJSON = await fetch(url, {\n            method: \"PUT\",\n            body: donneesFormulaire\n          });\n          let reponseJS = await reponseJSON.json();\n          console.log(reponseJS.msg);\n          this.restaurant.name = document.getElementById('name').value;\n          this.restaurant.cuisine = document.getElementById('cuisine').value;\n          this.restaurant.address.building = document.getElementById('building').value;\n          this.restaurant.address.street = document.getElementById('street').value;\n          this.restaurant.address.zipcode = document.getElementById('zipcode').value;\n          this.getDataFromServer(id); // on rafraichit\n        } catch (err) {\n          console.log(\"Erreur dans le fetchs PUT \" + err.msg);\n        }\n      },\n      initMap() {\n        console.log(\"Initialisation\");\n        this.map = this.L.map('map').setView([43.62663234302636, 7.064208984375001], 12);\n        this.tileLayer = this.L.tileLayer(\n                'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n                {\n                  maxZoom: 18,\n                  attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attribution\">CARTO</a>',\n                }\n        );\n        this.tileLayer.addTo(this.map);\n        this.map.on('click', (e) => {\n          var pos = e.latlng;\n          console.log(pos);\n        });\n      }\n    }\n  };\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n</style>\n"]}]}